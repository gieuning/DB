## 오라클 계정 추가
#### 기본형식
```sql
CREATE USER 유저이름
    IDENTIFIED BY 패스워드;
    
CREATE USER test
    IDENTIFIED BY test; -- ORA-65096: 공통 사용자 또는 롤 이름이 부적합
    
-- Oracle 12C 부터는 "test" 같은 형식으로는 계정 추가 불가
-- 일반 유저는 "c##test" 형식으로 추가해야 함 

CREATE USER c##test
    IDENTIFIED BY test;  
```

다음과 같이 추가된 유저 목록을 확인 할 수 있다.
``` sql
SELECT * FROM all_users;
```
![](https://velog.velcdn.com/images/uning20/post/e45b3bb4-3932-4d01-9bb2-5ee81360efc8/image.png)

CMD창에서 확인
![](https://velog.velcdn.com/images/uning20/post/76c7cedd-f710-4632-b976-8efc352c42d4/image.png)
접속을 해보게 되면
ORA-01045: 사용자 C##TEST는 CREATE SESSION 권한을 가지고있지 않음; 로그온이
거절되었습니다. 라는 문구가 나온다.

계정을 추가할때는 다양한 조건들이 오게 되는데 구차나서 한번에 조건을 만족해서 계정을 생성하려고 한다.

## 계정 생성 및 권한 설정
CONNECT: 접속 권한
RESOURCE: 사용자 객체를 생성할 수 있도록 하기위해서 시스템 권한을 묶어 놓는다.
TABLESPACE: 데이터를 저장할 수 있는 공간
계정 생성을 하기 전 다음과 같이 해준다
``` sql
-- 오라클 11g 처럼 계정 및 삭제가 가능하도록 설정한다.(현재 사용중인 버전 21c)
ALTER SESSION SET "_ORACLE_SCRIPT"= true; 
```
### 계정 생성 및 권한 설정 동시에
``` sql
GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO 계정명
    IDENTIFIED BY 패스워드
```

### 계정 삭제
- CASCADE: 계정에 객체가 존재해도 모든 객체를 삭제 후 계정 삭제
``` sql
DROP USER 계정명 CASCADE;
```

### DEFAULT 테이블스페이스 및 TEMPORARY 테이블 스페이스 변경
``` sql
ALTER USER 계정명 DEFAULT TABLESPACE USERS;
ALTER USER 계정명 TEMPORARY TABLESPACE TEMP;
```

### 사용자의 패스워드 변경 : 자기자신 또는 관리자가 변경
관리자는 일반 사용자의 패스워드는 모르지만 접속 못하게 막을 수는 있다.
``` sql
ALTER USER 계정명 IDENTIFIED BY 패스워드; -- 특수문자에는 ""가 필요하다
```

### 사용자가 LOCK이 설정되어 접속이 안될 경우
- 관리자(sys)가 LOCK을 풀어줘야 한다.
``` sql
ALTER USER 계정명 ACCOUNT UNLOCK;
```

## 이제 test라는 계정을 생성하고 권한을 설정 해보자.
```sql
ALTER SESSION SET "_ORACLE_SCRIPT"= true; 
GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO test
    IDENTIFIED BY "test"
ALTER USER test DEFAULT TABLESPACE USERS;
ALTER USER test TEMPORARY TABLESPACE TEMP; 
```
SQL Developer에서 확인
![](https://velog.velcdn.com/images/uning20/post/03d76623-65cf-4ae6-82b0-b19ae692739c/image.png)
CMD에서도 로그인 할 수 있다.
![](https://velog.velcdn.com/images/uning20/post/1d00c2b7-472e-4558-a072-3b971858c390/image.png)
### 비밀번호도 바꿔보자
![](https://velog.velcdn.com/images/uning20/post/ecba6af8-8cee-4ca3-b037-821230e664e1/image.png)

#### 이제 한번 sky 계정을 LOCK 해보자
여러번 sky계정에 잘못된 pwd을 입력해서 LOCK 건다.
![](https://velog.velcdn.com/images/uning20/post/25c6cdba-227a-4a68-a291-2a375aa8cb3d/image.png)

![](https://velog.velcdn.com/images/uning20/post/ff942cff-2804-49c9-8bd9-6ffc2d54b372/image.png)

다음과 같은 명령어로 LOKC을 풀 수 있다. (sys에서)
``` sql
ALTER USER sky ACCOUNT UNLOCK;
```

---
## 정리
```sql
ALTER SESSION SET "_ORACLE_SCRIPT"= true; 
GRANT CONNECT, RESOURCE, UNLIMITED TABLESPACE TO test
    IDENTIFIED BY "test"
ALTER USER test DEFAULT TABLESPACE USERS;
ALTER USER test TEMPORARY TABLESPACE TEMP; 
```
이 코드를 사용해서 권한을 주자.


